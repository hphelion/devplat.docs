<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="cloudMessaging">
  <title>HPE Helion 2.0 Development Platform: Messaging Broker Service Configuration</title>
  <body>
    <section><p>If you are installing the Messaging Broker service, add and populate the <codeph>messaging</codeph>
        and <codeph>msgaas</codeph> sections of the <codeph>clouds.yml</codeph> file as described
        below. All fields are required unless otherwise indicated.</p>
      <p>In your environment, the clouds.yaml file should be located at
          <codeph>~/.config/openstack/clouds.yaml</codeph>. If this file does not exist yet, <xref
          href="../install_cloudsyaml.dita">create it</xref>.</p>
      <p>
        <note type="important">This section begins indented two spaces; look at the <xref
            href="fullFile.dita">complete file</xref> to see how all the sections fit
          together.</note>
      </p>
      <codeblock id="cloudmsgaas">    messaging:
      deployer_cloud: "msgaas"
      deployer_ntp_servers: NTP servers, can be the same as the one used by HOS
      deployer_dns_servers: DNS servers, can be the same as the one used by HOS
      ##### These settings are optional. If you are not providing a value for them, delete them entirely. Do not leave blank.
      deployer_key: msgaas-key
      deployer_flavor: 3
      deployer_name: msgaas_deployer_01   
      deployer_security_group: default
      deployer_image: hlinux_msgaas
      deployer_ext_net_id: ext-net
      deployer_cname: CN name used to generate the certificate file.   
      #####          
    msgaas:
      image_api_version: '1'
      identity_api_version: '2'
      region_name: region1
      insecure: True
      auth:
        auth_url: http://##.##.##.##:####/v3
        project_name: 
        username: 
        password: 
        project_domain_name: default
        user_domain_name: default              </codeblock></section><section><title>Service Configuration Parameters for the HDPI Installer</title><dl>
        <dlentry>
          <dt>deployer_cloud</dt>
          <dd>The cloud identified in the clouds.yaml where the deployer will be created. Note that
            while the deployer creation must be performed by an admin, the deployer itself may be
            owned by someone else. Value must be "msgaas"</dd>
        </dlentry>
        <dlentry>
          <dt>deployer_ntp_servers</dt>
          <dd>NTP servers, provided as a list. Can be the same as the one used by HPE Helion
            OpenStack </dd>
        </dlentry>
        <dlentry>
          <dt>deployer_dns_servers</dt>
          <dd>DNS servers, provided as a list. Can be the same as the one used by HPE Helion
            OpenStack </dd>
        </dlentry>
        <dlentry>
          <dt>deployer_key (optional)</dt>
          <dd>The keypair to use to SSH into the deployer instance. Default value:
              <i>project_name</i>. If the keypair does not exist in Nova, it would get created using
            the default user SSH public key.</dd>
        </dlentry>
        <dlentry>
          <dt>deployer_flavor (optional)</dt>
          <dd>The flavor ID to use for the deployer instance. Default value: 4 (which is Large).
            Recommended flavor: 3 (Medium)</dd>
        </dlentry>
        <dlentry>
          <dt>deployer_name (optional)</dt>
          <dd>The name of the deployer instance. Default value:
              <i>service</i>_deployer_<i>version</i></dd>
        </dlentry>
        <dlentry>
          <dt>deployer_security_group (optional)</dt>
          <dd>The name of the security group for the deployer. Default value: default</dd>
        </dlentry>
        <dlentry>
          <dt>deployer_image (optional)</dt>
          <dd>The image to use for the deployer. It will attempt to find an image with the prefix
              <i>helionci</i> or <i>msgaas</i> and containing the word <i>hlinux</i>.</dd>
        </dlentry>
        <dlentry>
          <dt>deployer_ext_net_id (optional)</dt>
          <dd>The external network name. Default value: ext-net <note>This must be specified in the
              configuration file, but the value is not currently read- only the default is
              used.</note></dd>
        </dlentry>
        <dlentry>
          <dt>deployer_cname (optional)</dt>
          <dd>CN name used to generate the certificate file.</dd>
        </dlentry></dl>
      </section>
      <section><title>Cloud Configuration Parameters for the Messaging Installer</title>
        <dl>
        <dlentry>
          <dt> image_api_version(optional)</dt>
          <dd>The image API version to use. The default value is 1. </dd>
        </dlentry>
        <dlentry>
          <dt> identity_api_version (optional)</dt>
          <dd>The keystone API version to use. The default value is 2.</dd>
        </dlentry>
        <dlentry>
          <dt>region_name</dt>
          <dd>The region name to use. The default value is <codeph>region1</codeph></dd>
        </dlentry>
        <dlentry>
          <dt>insecure (optional)</dt>
          <dd>This flag will automatically accept an internally signed cert without prompting the
            user when connecting to the HPE Helion OpenStack services. Default value: True</dd>
        </dlentry>
        <dlentry>
          <dt>auth_url</dt>
          <dd>This URL can be found in Horizon at: Project &gt; Compute &gt; Access &amp; Security
            &gt; API Access. Copy the Service Endpoint URL for the Identity Service. This must be
            the <b>internal</b>, not the <i>admin</i> or <i>public</i> endpoints. If the default
            endpoint value ends in <codeph>/v2</codeph>, change it to <codeph>/v3</codeph> .</dd>
        </dlentry>
        <dlentry>
          <dt>project_name</dt>
          <dd>This project will be created by the HDPI service installation process. This project
            must NOT exist prior to installing the Messaging Broker Service.</dd>
        </dlentry>
        <dlentry>
          <dt>username</dt>
          <dd>This user will be created by the HDPI service installation process. This project must
            NOT exist prior to installing the Messaging Broker Service.</dd>
        </dlentry>
        <dlentry>
          <dt>password</dt>
          <dd>The Password for the same account with installation privileges (administrator
            role).</dd>
        </dlentry>
        <dlentry>
          <dt>project_domain_name: default</dt>
          <dd>Unless changes are required for your environment, accept the default value.</dd>
        </dlentry>
        <dlentry>
          <dt>user_domain_name: default </dt>
          <dd>Unless changes are required for your environment, accept the default value.</dd>
        </dlentry>
      </dl>
    </section>
  </body>
</topic>
